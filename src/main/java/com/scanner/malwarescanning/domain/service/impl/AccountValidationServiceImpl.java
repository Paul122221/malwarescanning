package com.scanner.malwarescanning.domain.service.impl;

import com.scanner.malwarescanning.domain.entity.Account;
import com.scanner.malwarescanning.domain.service.AccountValidationService;

import java.util.logging.Logger;

/**
 * Implementation of the AccountValidationService.
 * Provides functionality to validate account details, specifically the IBAN (International Bank Account Number).
 *
 * This implementation focuses on basic validation of the IBAN, such as checking for null values
 * and verifying the length of the IBAN.
 */
public class AccountValidationServiceImpl implements AccountValidationService {
    private static final Logger logger = Logger.getLogger(AccountValidationServiceImpl.class.getName());

    /**
     * Validates the IBAN of the given Account.
     *
     * The method ensures that the IBAN is not null and meets basic length requirements.
     * Note: As of now, this method does not perform complex validations such as checksums.
     *
     * @param account The account whose IBAN is to be validated.
     * @throws IllegalArgumentException if the IBAN is null or does not meet the basic length requirements.
     */
    @Override
    public void validate(Account account) {
        String iban = account.getIban();
        if (iban == null) {
            throw new IllegalArgumentException("IBAN can not be NULL!");
        }
        String ibanNoSpace = iban.replace(" ", "");
        if (ibanNoSpace.length() != 22) {
            throw new IllegalArgumentException("IBAN is invalid");
        }
        logger.info("IBAN is valid");
    }
}
